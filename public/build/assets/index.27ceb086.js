import{a as x}from"./index.83bc9570.js";const q=window.jQuery,z=window.bootstrap||{};var mt,bt;const f={baseUrl:"/api/wifi/admin",ownerBaseUrl:"/api/wifi/owner",csrf:(bt=(mt=document.querySelector('meta[name="csrf-token"]'))==null?void 0:mt.getAttribute("content"))!=null?bt:"",detailUrlTemplate:""};x.defaults.headers.common["X-Requested-With"]="XMLHttpRequest";x.defaults.withCredentials=!0;f.csrf&&(x.defaults.headers.common["X-CSRF-TOKEN"]=f.csrf);let H=null;function W(){return H||(H=x.get("/sanctum/csrf-cookie",{withCredentials:!0}).catch(t=>{throw console.error("Failed to initialize Sanctum CSRF cookie",t),H=null,t}),H)}const l={filters:{networkSearch:"",networkStatus:"",reportStatus:"",reportNetwork:""},selectedNetwork:null,selectedReport:null,tables:{}},ft={active:"\u0646\u0634\u0637",inactive:"\u0645\u062A\u0648\u0642\u0641",suspended:"\u0645\u0639\u0644\u0651\u0642"},vt={active:"bg-success text-white",inactive:"bg-secondary text-white",suspended:"bg-warning text-dark"},B={open:"\u0645\u0641\u062A\u0648\u062D",investigating:"\u0642\u064A\u062F \u0627\u0644\u0645\u062A\u0627\u0628\u0639\u0629",resolved:"\u062A\u0645 \u0627\u0644\u062D\u0644",dismissed:"\u0645\u0631\u0641\u0648\u0636"},_t={open:"bg-danger text-white",investigating:"bg-warning text-dark",resolved:"bg-success text-white",dismissed:"bg-secondary text-white"},pt={uploaded:"\u0645\u0631\u0641\u0648\u0639",validated:"\u0642\u064A\u062F \u0627\u0644\u0645\u0631\u0627\u062C\u0639\u0629",active:"\u0645\u0641\u0639\u0644",archived:"\u0645\u0624\u0631\u0634\u0641"},yt={uploaded:"bg-secondary text-white",validated:"bg-info text-dark",active:"bg-success text-white",archived:"bg-dark text-white"},g={success(t){typeof window.showSuccessToast=="function"?window.showSuccessToast(t):console.info(t)},error(t){typeof window.showErrorToast=="function"?window.showErrorToast(t):console.error(t)}},U="\u2014";function St(t,s=300){let a;return(...o)=>{clearTimeout(a),a=window.setTimeout(()=>t.apply(null,o),s)}}function k(t){const s=Number.parseFloat(t);return Number.isNaN(s)?U:s.toLocaleString(void 0,{maximumFractionDigits:2})}function I(t){if(!t)return U;try{const s=new Date(t);return Number.isNaN(s.getTime())?t:s.toLocaleString()}catch{return t}}function M(t){var s;if(!t)return"\u062D\u062F\u062B \u062E\u0637\u0623 \u063A\u064A\u0631 \u0645\u062A\u0648\u0642\u0639.";if((s=t.response)!=null&&s.data){const a=t.response.data;if(typeof a.message=="string")return a.message;if(a.errors&&typeof a.errors=="object")return Object.values(a.errors).flat().join(" ")}return t.message?t.message:"\u062D\u062F\u062B \u062E\u0637\u0623 \u063A\u064A\u0631 \u0645\u062A\u0648\u0642\u0639."}function rt(t){var o,e,n,r,i,c,d,u;if(!t||typeof t!="object")return{total:0,rows:[]};if(Array.isArray(t))return{total:t.length,rows:t};if(Array.isArray(t.rows)&&typeof t.total=="number")return{total:t.total,rows:t.rows};if(Array.isArray(t.data))return{total:(n=(e=t.total)!=null?e:(o=t.meta)==null?void 0:o.total)!=null?n:t.data.length,rows:t.data};const s=(i=(r=t.items)!=null?r:t.list)!=null?i:[];return{total:(u=(d=t.total)!=null?d:(c=t.meta)==null?void 0:c.total)!=null?u:s.length,rows:s}}function it(t){var e,n;const s=Number.parseInt((e=t.limit)!=null?e:10,10),a=Number.parseInt((n=t.offset)!=null?n:0,10),o=s>0?Math.floor(a/s)+1:1;return{limit:s,offset:a,page:o}}function Tt(t){var w,v,$,A,m,p,_,y,S,T,N,C,L,R,F,D,O,P,E,K,Q,Y,G,V,J,Z,tt,et,at,st,nt,ot;const s=(w=t.meta)!=null?w:{},a=(v=t.settings)!=null?v:{},o=(A=($=t.statistics)!=null?$:s.statistics)!=null?A:{},e=(p=(m=t.coverage_radius_km)!=null?m:s.coverage_radius_km)!=null?p:null,n=(T=(S=(_=s.owner)==null?void 0:_.name)!=null?S:(y=t.owner)==null?void 0:y.name)!=null?T:U,r=(R=(L=(N=s.owner)==null?void 0:N.email)!=null?L:(C=t.owner)==null?void 0:C.email)!=null?R:U,i=(P=(O=(F=s.owner)==null?void 0:F.mobile)!=null?O:(D=s.owner)==null?void 0:D.phone)!=null?P:U,c=(K=(E=o.codes)!=null?E:s.codes)!=null?K:{},d=(Y=(Q=c.sold)!=null?Q:s.codes_sold)!=null?Y:null,u=(V=(G=c.available)!=null?G:s.codes_available)!=null?V:null,b=(Z=(J=c.total)!=null?J:s.codes_total)!=null?Z:null;return{...t,owner_name:n,owner_email:r,owner_phone:i,coverage_radius_km:e,commission_rate:(et=(tt=a.commission_rate)!=null?tt:s.commission_rate)!=null?et:null,codes_summary:{available:u,sold:d,total:b},active_plans:(ot=(nt=(st=(at=o.plans)==null?void 0:at.active)!=null?st:t.active_plans_count)!=null?nt:t.plan_count)!=null?ot:null}}function Nt(t){var s,a,o,e,n,r,i;return{...t,network_name:(n=(o=(s=t.network)==null?void 0:s.name)!=null?o:(a=t.meta)==null?void 0:a.network_name)!=null?n:`#${(e=t.network_id)!=null?e:U}`,created_at:(i=(r=t.created_at)!=null?r:t.reported_at)!=null?i:t.updated_at}}async function ct(t,s,a){const o=typeof a=="function"?a(s):s.data;try{await W();const e=await x.get(t,{params:o});s.success(e.data)}catch(e){s.error(e),g.error(M(e))}}async function j(t,s){return await W(),x.patch(t,s,{headers:{"X-CSRF-TOKEN":f.csrf,"X-Requested-With":"XMLHttpRequest"}})}const $t={owner:"\u0645\u0627\u0644\u0643 \u0627\u0644\u0634\u0628\u0643\u0629",manager:"\u0627\u0644\u0645\u0633\u0624\u0648\u0644",phone:"\u0627\u0644\u0647\u0627\u062A\u0641",whatsapp:"\u0648\u0627\u062A\u0633\u0627\u0628",email:"\u0627\u0644\u0628\u0631\u064A\u062F \u0627\u0644\u0625\u0644\u0643\u062A\u0631\u0648\u0646\u064A",support:"\u0642\u0646\u0627\u0629 \u0627\u0644\u062F\u0639\u0645"},lt="\u062C\u0627\u0631\u064D \u062A\u062D\u0645\u064A\u0644 \u0627\u0644\u0628\u064A\u0627\u0646\u0627\u062A...",qt="\u0644\u0627 \u062A\u062A\u0648\u0641\u0631 \u0628\u064A\u0627\u0646\u0627\u062A \u0627\u062A\u0635\u0627\u0644.",xt="\u0644\u0627 \u062A\u0648\u062C\u062F \u062A\u0641\u0627\u0635\u064A\u0644 \u0625\u0636\u0627\u0641\u064A\u0629.",Ct="\u0644\u0627 \u062A\u0648\u062C\u062F \u062E\u0637\u0637 \u0628\u0639\u062F.",Lt="\u0644\u0627 \u062A\u0648\u062C\u062F \u062F\u0641\u0639\u0627\u062A \u0645\u0631\u062A\u0628\u0637\u0629.";function X(t){if(!t)return null;const s=z.Modal?z.Modal.getOrCreateInstance(t):null;return s==null||s.show(),s}function wt(t){if(!t)return;const s=z.Modal?z.Modal.getInstance(t):null;s==null||s.hide()}function h(t,s,a,o=e=>e!=null?e:"\u2014"){const e=t.querySelector(s);e&&(e.textContent=o(a))}function ht(t){var i,c,d,u,b,w,v,$,A,m,p,_,y,S,T,N,C,L,R,F,D,O,P;const s=document.querySelector("[data-wifi-network-modal]");if(!s||!t)return;h(s,"[data-network-name]",t.name),h(s,"[data-network-subtitle]",t.slug?`#${t.slug}`:xt),h(s,"[data-network-status-label]",(c=(i=ft[t.status])!=null?i:t.status)!=null?c:"\u2014");const a=(w=(u=t.commission_rate)!=null?u:(d=t.settings)==null?void 0:d.commission_rate)!=null?w:(b=t.meta)==null?void 0:b.commission_rate;h(s,"[data-network-commission]",a,E=>E!=null?`${k(E*100)}%`:"\u2014"),h(s,"[data-network-address]",($=t.address)!=null?$:(v=t.meta)==null?void 0:v.address),h(s,"[data-network-owner]",(p=t.owner_name)!=null?p:(m=(A=t.meta)==null?void 0:A.owner)==null?void 0:m.name),h(s,"[data-network-owner-email]",(S=t.owner_email)!=null?S:(y=(_=t.meta)==null?void 0:_.owner)==null?void 0:y.email),h(s,"[data-network-owner-phone]",(C=t.owner_phone)!=null?C:(N=(T=t.meta)==null?void 0:T.owner)==null?void 0:N.mobile),h(s,"[data-network-support-channel]",(L=t.meta)==null?void 0:L.support_channel);const o=(R=t.updated_at)!=null?R:t.created_at;h(s,"[data-network-updated-at]",I(o));const e=s.querySelector("[data-network-logo]");if(e){const E=(F=e.getAttribute("data-custom-image"))!=null?F:e.getAttribute("src");e.setAttribute("src",(P=(O=t.icon_path)!=null?O:(D=t.meta)==null?void 0:D.icon_path)!=null?P:E)}gt(s,t.statistics,t),kt(s,t.contacts);const n=s.querySelector("[data-network-plans-container]");n&&(n.innerHTML=`<p class="text-muted mb-0">${lt}</p>`);const r=s.querySelector("[data-network-batches-container]");r&&(r.innerHTML=`<p class="text-muted mb-0">${lt}</p>`)}function gt(t,s={},a={}){var n,r,i,c,d,u,b,w;const o=(n=s.plans)!=null?n:{},e=(i=(r=s.codes)!=null?r:a.codes_summary)!=null?i:{};h(t,"[data-network-active-plans]",(d=(c=o.active)!=null?c:a.active_plans_count)!=null?d:0,k),h(t,"[data-network-total-codes]",(u=e.total)!=null?u:0,k),h(t,"[data-network-available-codes]",(b=e.available)!=null?b:0,k),h(t,"[data-network-sold-codes]",(w=e.sold)!=null?w:0,k)}function kt(t,s){const a=t.querySelector("[data-network-contacts]");if(!a)return;const o=Array.isArray(s)?s:[];if(o.length===0){a.innerHTML=`<li class="wifi-network-info__item text-muted">${qt}</li>`;return}a.innerHTML="",o.forEach(e=>{var c,d,u;const n=document.createElement("li");n.className="wifi-network-info__item";const r=(d=(c=$t[e.type])!=null?c:e.type)!=null?d:"\u2014",i=(u=e.value)!=null?u:"\u2014";n.innerHTML=`<span>${r}</span><span>${i}</span>`,a.appendChild(n)})}async function Et(t){var r,i,c,d;const s=document.querySelector("[data-wifi-network-modal]");if(!s||!t)return;const a=s.querySelector("[data-network-plans-container]"),o=s.querySelector("[data-network-plans-count]"),e=s.querySelector("[data-network-batches-container]"),n=s.querySelector("[data-network-batches-count]");try{const u=await x.get(`${f.ownerBaseUrl}/networks/${t}`),b=(i=(r=u.data)==null?void 0:r.data)!=null?i:u.data,w={...l.selectedNetwork,...b};l.selectedNetwork=w,ht(w);const v=(c=b==null?void 0:b.plans)!=null?c:[];a&&(v.length>0?(a.innerHTML="",v.forEach(m=>{var _,y,S,T,N,C,L;const p=document.createElement("div");p.className="wifi-network-plans__item",p.innerHTML=`
                        <div>
                            <strong>${(_=m.name)!=null?_:"\u2014"}</strong>
                            <div class="text-muted small">${(y=m.status)!=null?y:""}</div>
                        </div>
                        <div class="text-end">
                            <div>${k((S=m.price)!=null?S:0)} ${(T=m.currency)!=null?T:""}</div>
                            <div class="text-muted small">${k((L=(C=m.code_batches_count)!=null?C:(N=m.meta)==null?void 0:N.code_batches_count)!=null?L:0)} \u062F\u0641\u0639\u0627\u062A</div>
                        </div>
                    `,a.appendChild(p)})):a.innerHTML=`<p class="text-muted mb-0">${Ct}</p>`),o&&(o.textContent=String(v.length));const $=v.flatMap(m=>{var p;return(p=m.code_batches)!=null?p:[]});e&&($.length>0?(e.innerHTML="",$.slice(0,5).forEach(m=>{var _,y,S,T,N;const p=document.createElement("div");p.className="wifi-network-plans__item",p.innerHTML=`
                        <div>
                            <strong>${(_=m.label)!=null?_:"\u2014"}</strong>
                            <div class="text-muted small">${(S=(y=pt[m.status])!=null?y:m.status)!=null?S:"\u2014"}</div>
                        </div>
                        <div class="text-end">
                            <div>${k((T=m.available_codes)!=null?T:0)} / ${k((N=m.total_codes)!=null?N:0)}</div>
                            <div class="text-muted small">${I(m.created_at)}</div>
                        </div>
                    `,e.appendChild(p)})):e.innerHTML=`<p class="text-muted mb-0">${Lt}</p>`),n&&(n.textContent=String($.length));const A=At(v,$);gt(s,A,w),kt(s,(d=b.contacts)!=null?d:w.contacts)}catch(u){g.error(M(u))}}function At(t,s){const a=t.filter(n=>{var r;return((r=n.status)!=null?r:"").toLowerCase()==="active"}).length,o=t.length,e=s.reduce((n,r)=>{var d,u;const i=Number((d=r.total_codes)!=null?d:0),c=Number((u=r.available_codes)!=null?u:0);return n.total+=i,n.available+=c,n.sold+=Math.max(i-c,0),n},{total:0,available:0,sold:0});return{plans:{active:a,total:o},codes:e}}function dt(t){const s=q("#wifi-network-batches-table");!s.length||!t||(s.bootstrapTable("removeAll"),W().then(()=>x.get(`${f.ownerBaseUrl}/networks/${t}`)).then(a=>{var n,r,i;const o=(r=(n=a.data)==null?void 0:n.data)!=null?r:a.data,e=((i=o==null?void 0:o.plans)!=null?i:[]).flatMap(c=>{var u,b;const d=(u=c.name)!=null?u:"\u2014";return((b=c.code_batches)!=null?b:[]).map(w=>({...w,plan:d}))});Array.isArray(e)&&s.bootstrapTable("append",e)}).catch(a=>{g.error(M(a))}))}function Mt(){!q("#wifi-batches-table").length||W().then(()=>x.get(`${f.baseUrl}/reports`,{params:{per_page:5}})).then(()=>{}).catch(()=>{})}function Bt(){var s;const t=(s=window.MaribWifiAdminTables)!=null?s:window.MaribWifiAdminTables={};return t.__initialized||(t.__initialized=!0,t.formatDate=a=>I(a),t.formatNetworkStatus=a=>{var n,r,i;const o=(n=vt[a])!=null?n:"bg-light text-dark",e=(i=(r=ft[a])!=null?r:a)!=null?i:"\u2014";return`<span class="badge ${o}">${e}</span>`},t.formatCodesSummary=(a,o)=>{var c,d,u,b;const e=(c=a!=null?a:o.codes_summary)!=null?c:{},n=k((d=e.total)!=null?d:0),r=k((u=e.available)!=null?u:0),i=k((b=e.sold)!=null?b:0);return`
        <div class="d-flex flex-column">
            <span class="fw-semibold">${n}</span>
            <small class="text-muted">\u0645\u062A\u0627\u062D: ${r} | \u0645\u0628\u064A\u0639: ${i}</small>
        </div>
    `},t.formatCommission=(a,o)=>{var r,i;const e=(i=a!=null?a:o.commission_rate)!=null?i:(r=o.settings)==null?void 0:r.commission_rate;return e==null?'<span class="text-muted">\u2014</span>':`${(Number.parseFloat(e)*100).toFixed(2)}%`},t.formatNetworkActions=()=>`
    <div class="btn-group btn-group-sm" role="group">
        <button type="button" class="btn btn-outline-primary" data-action="view-network" title="\u0639\u0631\u0636 \u0627\u0644\u062A\u0641\u0627\u0635\u064A\u0644">
            <i class="bi bi-eye"></i>
        </button>
        <button type="button" class="btn btn-outline-warning" data-action="edit-status" title="\u062A\u062D\u062F\u064A\u062B \u0627\u0644\u062D\u0627\u0644\u0629">
            <i class="bi bi-shield-check"></i>
        </button>
        <button type="button" class="btn btn-outline-success" data-action="edit-commission" title="\u062A\u0639\u062F\u064A\u0644 \u0627\u0644\u0639\u0645\u0648\u0644\u0629">
            <i class="bi bi-cash-stack"></i>
        </button>
        <button type="button" class="btn btn-outline-secondary" data-action="manage-batches" title="\u0625\u062F\u0627\u0631\u0629 \u0627\u0644\u062F\u0641\u0639\u0627\u062A">
            <i class="bi bi-collection"></i>
        </button>
    </div>
`,t.networkActionEvents={'click [data-action="view-network"]'(a,o,e){if(f.detailUrlTemplate){const n=f.detailUrlTemplate.replace("__NETWORK__",e.id);window.location.href=n;return}l.selectedNetwork=e,ht(e),X(document.querySelector("[data-wifi-network-modal]")),Et(e.id)},'click [data-action="edit-status"]'(a,o,e){var c;l.selectedNetwork=e;const n=document.querySelector("[data-wifi-status-modal]"),r=n==null?void 0:n.querySelector("#wifi_network_status");r&&(r.value=(c=e.status)!=null?c:"");const i=n==null?void 0:n.querySelector("#wifi_network_reason");i&&(i.value=""),X(n)},'click [data-action="edit-commission"]'(a,o,e){var i,c,d;l.selectedNetwork=e;const n=document.querySelector("[data-wifi-commission-modal]"),r=n==null?void 0:n.querySelector("#wifi_network_commission");if(r){const u=(d=(c=e.commission_rate)!=null?c:(i=e.settings)==null?void 0:i.commission_rate)!=null?d:0;r.value=(Number.parseFloat(u)*100).toFixed(2)}X(n)},'click [data-action="manage-batches"]'(a,o,e){l.selectedNetwork=e;const n=document.querySelector("[data-wifi-batches-modal]"),r=n==null?void 0:n.querySelector("[data-network-batches-subtitle]");r&&(r.textContent=e.name?`\u062F\u0641\u0639\u0627\u062A \u0627\u0644\u0623\u0643\u0648\u0627\u062F \u0644\u0644\u0634\u0628\u0643\u0629: ${e.name}`:"\u062F\u0641\u0639\u0627\u062A \u0627\u0644\u0623\u0643\u0648\u0627\u062F \u0627\u0644\u0645\u0631\u062A\u0628\u0637\u0629 \u0628\u0627\u0644\u0634\u0628\u0643\u0629."),X(n),dt(e.id)}},t.fetchNetworks=a=>ct(`${f.baseUrl}/networks`,a,o=>{var i,c;const e=(i=o.data)!=null?i:{},n=it(e),r={per_page:n.limit,page:n.page};return e.sort&&(r.sort=e.sort,r.direction=(c=e.order)!=null?c:"desc"),l.filters.networkStatus&&(r.status=l.filters.networkStatus),l.filters.networkSearch&&(r.q=l.filters.networkSearch),r}),t.networkQueryParams=a=>a,t.transformNetworkResponse=a=>{const o=rt(a);return{total:o.total,rows:o.rows.map(Tt)}},t.fetchReports=a=>ct(`${f.baseUrl}/reports`,a,o=>{var i,c;const e=(i=o.data)!=null?i:{},n=it(e),r={per_page:n.limit,page:n.page};return e.sort&&(r.sort=e.sort,r.direction=(c=e.order)!=null?c:"desc"),l.filters.reportStatus&&(r.status=l.filters.reportStatus),l.filters.reportNetwork&&(r.network_id=l.filters.reportNetwork),r}),t.reportQueryParams=a=>a,t.transformReportResponse=a=>{const o=rt(a);return{total:o.total,rows:o.rows.map(Nt)}},t.formatReportStatus=a=>{var n,r,i;const o=(n=_t[a])!=null?n:"bg-light text-dark",e=(i=(r=B[a])!=null?r:a)!=null?i:"\u2014";return`<span class="badge ${o}">${e}</span>`},t.formatReportActions=()=>`
    <div class="btn-group btn-group-sm" role="group">
        <button type="button" class="btn btn-outline-primary" data-action="view-report" title="\u0639\u0631\u0636 \u0627\u0644\u0628\u0644\u0627\u063A">
            <i class="bi bi-eye"></i>
        </button>
        <button type="button" class="btn btn-outline-secondary dropdown-toggle dropdown-toggle-split" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
            <span class="visually-hidden">\u062A\u063A\u064A\u064A\u0631 \u0627\u0644\u062D\u0627\u0644\u0629</span>
        </button>
        <ul class="dropdown-menu dropdown-menu-end">
            <li><button class="dropdown-item" data-action="report-status" data-status="open">${B.open}</button></li>
            <li><button class="dropdown-item" data-action="report-status" data-status="investigating">${B.investigating}</button></li>
            <li><button class="dropdown-item" data-action="report-status" data-status="resolved">${B.resolved}</button></li>
            <li><button class="dropdown-item" data-action="report-status" data-status="dismissed">${B.dismissed}</button></li>
        </ul>
    </div>
`,t.reportActionEvents={'click [data-action="view-report"]'(a,o,e){const r=[e.title,e.description].filter(Boolean).join(`

`);r?window.alert(r):window.alert("\u0644\u0627 \u062A\u0648\u062C\u062F \u062A\u0641\u0627\u0635\u064A\u0644 \u0625\u0636\u0627\u0641\u064A\u0629 \u0644\u0647\u0630\u0627 \u0627\u0644\u0628\u0644\u0627\u063A.")},'click [data-action="report-status"]'(a,o,e){var i,c;const n=(i=a.currentTarget)==null?void 0:i.getAttribute("data-status");!n||!window.confirm(`\u0647\u0644 \u062A\u0631\u063A\u0628 \u0628\u062A\u062D\u062F\u064A\u062B \u062D\u0627\u0644\u0629 \u0627\u0644\u0628\u0644\u0627\u063A \u0625\u0644\u0649 "${(c=B[n])!=null?c:n}"\u061F`)||j(`${f.baseUrl}/reports/${e.id}`,{status:n}).then(()=>{var d;g.success("\u062A\u0645 \u062A\u062D\u062F\u064A\u062B \u062D\u0627\u0644\u0629 \u0627\u0644\u0628\u0644\u0627\u063A \u0628\u0646\u062C\u0627\u062D."),(d=l.tables.reports)==null||d.bootstrapTable("refresh")}).catch(d=>{g.error(M(d))})}},t.formatBatchStatus=a=>{var n,r,i;const o=(n=yt[a])!=null?n:"bg-light text-dark",e=(i=(r=pt[a])!=null?r:a)!=null?i:"\u2014";return`<span class="badge ${o}">${e}</span>`},t.formatBatchActions=()=>`
    <div class="btn-group btn-group-sm" role="group">
        <button type="button" class="btn btn-outline-primary" data-action="open-batch" title="\u0639\u0631\u0636 \u0627\u0644\u062A\u0641\u0627\u0635\u064A\u0644">
            <i class="bi bi-eye"></i>
        </button>
        <button type="button" class="btn btn-outline-success" data-action="activate-batch" title="\u062A\u0641\u0639\u064A\u0644">
            <i class="bi bi-check-circle"></i>
        </button>
    </div>
`,t.batchActionEvents={'click [data-action="open-batch"]'(a,o,e){var r,i;const n=`\u0627\u0644\u0648\u0633\u0645: ${e.label}
\u0627\u0644\u062E\u0637\u0629: ${(r=e.plan)!=null?r:"\u2014"}
\u0627\u0644\u0625\u062C\u0645\u0627\u0644\u064A: ${(i=e.total_codes)!=null?i:0}`;window.alert(n)},'click [data-action="activate-batch"]'(a,o,e){if(!(e!=null&&e.id))return;const n=`${f.ownerBaseUrl}/batches/${e.id}/status`;!window.confirm('\u0633\u064A\u062A\u0645 \u062A\u062D\u062F\u064A\u062B \u062D\u0627\u0644\u0629 \u0627\u0644\u062F\u0641\u0639\u0629 \u0625\u0644\u0649 "active"\u060C \u0647\u0644 \u062A\u0631\u063A\u0628 \u0628\u0627\u0644\u0627\u0633\u062A\u0645\u0631\u0627\u0631\u061F')||j(n,{status:"active"}).then(()=>{var i;g.success("\u062A\u0645 \u0625\u0631\u0633\u0627\u0644 \u0637\u0644\u0628 \u062A\u0641\u0639\u064A\u0644 \u0627\u0644\u062F\u0641\u0639\u0629."),dt((i=l.selectedNetwork)==null?void 0:i.id)}).catch(i=>{g.error(M(i))})}}),t}function Ut(){const t=document.querySelector("[data-network-search]"),s=document.querySelector("[data-network-status-filter]"),a=document.querySelector('[data-action="refresh-networks"]');t&&t.addEventListener("input",St(o=>{var e,n;l.filters.networkSearch=(e=o.target.value)!=null?e:"",(n=l.tables.networks)==null||n.bootstrapTable("refresh")},400)),s&&s.addEventListener("change",o=>{var e,n;l.filters.networkStatus=(e=o.target.value)!=null?e:"",(n=l.tables.networks)==null||n.bootstrapTable("refresh")}),a&&a.addEventListener("click",()=>{var o;(o=l.tables.networks)==null||o.bootstrapTable("refresh")})}function Rt(){const t=document.querySelector("[data-report-status-filter]"),s=document.querySelector("[data-report-network-filter]"),a=document.querySelector('[data-action="refresh-reports"]');t&&t.addEventListener("change",o=>{var e,n;l.filters.reportStatus=(e=o.target.value)!=null?e:"",(n=l.tables.reports)==null||n.bootstrapTable("refresh")}),s&&s.addEventListener("change",o=>{var n;const e=o.target.value;l.filters.reportNetwork=e&&Number.parseInt(e,10)||"",(n=l.tables.reports)==null||n.bootstrapTable("refresh")}),a&&a.addEventListener("click",()=>{var o;(o=l.tables.reports)==null||o.bootstrapTable("refresh")})}function Ft(){const t=document.querySelector("[data-batch-status-filter]");t&&t.addEventListener("change",()=>{const a=q("#wifi-network-batches-table"),o=t.value;if(!a.length)return;if(!o){a.bootstrapTable("refreshOptions",{data:a.bootstrapTable("getData")});return}const e=a.bootstrapTable("getData").filter(n=>n.status===o);a.bootstrapTable("load",e)});const s=document.querySelector("[data-batch-status-filter-main]");s&&s.addEventListener("change",()=>{const a=q("#wifi-batches-table").bootstrapTable("getData");if(!Array.isArray(a))return;const o=s.value;if(!o){q("#wifi-batches-table").bootstrapTable("load",a);return}const e=a.filter(n=>n.status===o);q("#wifi-batches-table").bootstrapTable("load",e)})}function Dt(){const t=document.querySelector("[data-network-status-form]");!t||t.addEventListener("submit",s=>{var n;if(s.preventDefault(),!((n=l.selectedNetwork)!=null&&n.id)){g.error("\u064A\u0631\u062C\u0649 \u0627\u062E\u062A\u064A\u0627\u0631 \u0634\u0628\u0643\u0629 \u0623\u0648\u0644\u0627\u064B.");return}const a=t.querySelector('[name="status"]').value,o=t.querySelector('[name="reason"]').value,e=t.querySelector("[data-network-status-feedback]");e&&(e.textContent="\u062C\u0627\u0631\u064A \u0645\u0639\u0627\u0644\u062C\u0629 \u0627\u0644\u0637\u0644\u0628..."),j(`${f.baseUrl}/networks/${l.selectedNetwork.id}/status`,{status:a,reason:o}).then(()=>{var r;e&&(e.textContent="\u062A\u0645 \u062A\u062D\u062F\u064A\u062B \u0627\u0644\u062D\u0627\u0644\u0629 \u0628\u0646\u062C\u0627\u062D."),g.success("\u062A\u0645 \u062A\u062D\u062F\u064A\u062B \u062D\u0627\u0644\u0629 \u0627\u0644\u0634\u0628\u0643\u0629."),(r=l.tables.networks)==null||r.bootstrapTable("refresh"),wt(document.querySelector("[data-wifi-status-modal]"))}).catch(r=>{const i=M(r);e&&(e.textContent=i),g.error(i)})})}function Ot(){const t=document.querySelector("[data-network-commission-form]");!t||t.addEventListener("submit",s=>{var r,i;if(s.preventDefault(),!((r=l.selectedNetwork)!=null&&r.id)){g.error("\u064A\u0631\u062C\u0649 \u0627\u062E\u062A\u064A\u0627\u0631 \u0634\u0628\u0643\u0629 \u0623\u0648\u0644\u0627\u064B.");return}const a=t.querySelector('[name="commission_rate"]'),o=t.querySelector("[data-network-commission-feedback]"),e=Number.parseFloat((i=a==null?void 0:a.value)!=null?i:"0");if(Number.isNaN(e)){g.error("\u064A\u0631\u062C\u0649 \u0625\u062F\u062E\u0627\u0644 \u0642\u064A\u0645\u0629 \u0635\u0627\u0644\u062D\u0629.");return}o&&(o.textContent="\u062C\u0627\u0631\u064A \u062A\u062D\u062F\u064A\u062B \u0627\u0644\u0639\u0645\u0648\u0644\u0629...");const n={commission_rate:e/100};j(`${f.ownerBaseUrl}/networks/${l.selectedNetwork.id}/commission`,n).then(()=>{var c;o&&(o.textContent="\u062A\u0645 \u062A\u062D\u062F\u064A\u062B \u0627\u0644\u0639\u0645\u0648\u0644\u0629 \u0628\u0646\u062C\u0627\u062D."),g.success("\u062A\u0645 \u062A\u062D\u062F\u064A\u062B \u0639\u0645\u0648\u0644\u0629 \u0627\u0644\u0634\u0628\u0643\u0629."),(c=l.tables.networks)==null||c.bootstrapTable("refresh"),wt(document.querySelector("[data-wifi-commission-modal]"))}).catch(c=>{const d=M(c);o&&(o.textContent=d),g.error(d)})})}Bt();function ut(){var s,a;const t=document.querySelector("[data-wifi-admin-root]");!t||t.dataset.initialized||typeof q>"u"||(t.dataset.initialized="true",f.baseUrl=t.dataset.baseUrl||f.baseUrl,f.ownerBaseUrl=t.dataset.ownerBaseUrl||f.ownerBaseUrl,f.detailUrlTemplate=t.dataset.detailUrl||f.detailUrlTemplate,l.tables.networks=q("#wifi-networks-table"),l.tables.reports=q("#wifi-reports-table"),Ut(),Rt(),Ft(),Dt(),Ot(),Mt(),(s=l.tables.networks)!=null&&s.length&&l.tables.networks.bootstrapTable("refresh"),(a=l.tables.reports)!=null&&a.length&&l.tables.reports.bootstrapTable("refresh"))}document.readyState==="loading"?document.addEventListener("DOMContentLoaded",ut,{once:!0}):ut();
